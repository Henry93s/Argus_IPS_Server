# ================================
# rules.conf - Argus IDS Ruleset
# ================================

# --------------------------------
# 1. 기본적인 접근 탐지(10.0.0.10 : 내부 webCam Server ip, 192.168.2.235:8080 : webCam WebServer)
# --------------------------------
ALERT TCP any any -> 192.168.2.98 8080 (type:header; msg:"WebCam WebServer Access")

# --------------------------------
# 2. DNS 요청 탐지
# --------------------------------
ALERT UDP any any -> 192.168.2.98 53 (type:payload; msg:"Google DNS Query Detected"; content:"google.com")

# --------------------------------
# 3. 포트 스캐닝 탐지
# --------------------------------
ALERT TCP any any -> 192.168.2.98 any (type:header; flags:S; msg:"Potential SYN Scan Detected")
ALERT TCP any any -> 192.168.2.98 any (type:header; flags:F; msg:"Potential FIN Scan Detected")
ALERT TCP any any -> 192.168.2.98 any (type:header; flags:0; msg:"Potential NULL Scan Detected")

# --------------------------------
# 4. SQL Injection 탐지 (Payload 기반)
# --------------------------------
ALERT TCP any any -> 192.168.2.98 80 (type:payload; msg:"SQL Injection Attempt - SELECT"; content:"SELECT "; pcre:"/SELECT\s+/i";)
ALERT TCP any any -> 192.168.2.98 80 (type:payload; msg:"SQL Injection Attempt - UNION SELECT"; content:"UNION SELECT"; pcre:"/UNION\s+SELECT/i";)
ALERT TCP any any -> 192.168.2.98 80 (type:payload; msg:"SQL Injection Attempt - 1=1"; content:"' OR '1'='1"; pcre:"/'\s*OR\s*'1'='1/i";)

# --------------------------------
# 5. Cross-Site Scripting (XSS) 탐지
# --------------------------------
ALERT TCP any any -> 192.168.2.98 80 (type:payload; msg:"XSS Attempt - <script>"; content:"<script>"; pcre:"/<script.*?>/i";)
ALERT TCP any any -> 192.168.2.98 80 (type:payload; msg:"XSS Attempt - javascript:"; content:"javascript:"; pcre:"/javascript\s*:/i";)

# --------------------------------
# 6.  탐지
# --------------------------------


# --------------------------------
# 7. HTTP Payload 탐지
# --------------------------------
ALERT TCP any any -> 192.168.2.98 80 (type:payload; msg:"HTTP GET Detected"; content:"GET "; pcre:"/^GET\s+/i";)
ALERT TCP any any -> 192.168.2.98 80 (type:payload; msg:"HTTP POST Detected"; content:"POST "; pcre:"/^POST\s+/i";)
ALERT TCP any any -> 192.168.2.98 80 (type:payload; msg:"Potential Directory Traversal"; content:"../"; pcre:"/(\.\.\/|%2e%2e%2f)+/i";)

# --------------------------------
# 8. 기타 유용한 탐지
# --------------------------------
ALERT ICMP any any -> 192.168.2.98 any (type:payload; msg:"ICMP Echo Request Detected"; content:"")
ALERT TCP any any -> 192.168.2.98 21 (type:payload; msg:"FTP Login Attempt"; content:"USER ")
ALERT TCP any any -> 192.168.2.98 21 (type:payload; msg:"FTP Password Attempt"; content:"PASS ")

# --------------------------------
# 9. Brute force 
# --------------------------------
# ALERT TCP any any -> 192.168.2.98 22 (type:payload; msg:"SSH Login Attempt"; content:"SSH-")

# --------------------------------
# 10. 취약 서비스 접근 탐지
# --------------------------------
ALERT TCP any any -> 192.168.2.98 23 (type:header; msg:"Telnet Access Attempt")
ALERT UDP any any -> 192.168.2.98 69 (type:header; msg:"TFTP Access Attempt")

# --------------------------------
# 11. 비정상 세션 / Flooding
# --------------------------------
ALERT TCP any any -> 192.168.2.98 80 (type:header; flags:S; msg:"Half-Open SYN Connection Detected")
ALERT ICMP any any -> 192.168.2.98 any (type:header; msg:"ICMP Flood Attempt Detected")
